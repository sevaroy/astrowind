---
/**
 * GumroadOverlay.astro - 加载 Gumroad Overlay 功能
 * 这个组件用于加载 Gumroad 的结账脚本，支持 Overlay 结账模式
 */
---

<script is:inline>
  // 确保只在浏览器环境中执行
  if (typeof window !== 'undefined') {
    // 防止重复加载
    if (!window.__gumroadScriptLoaded) {
      (function(){
        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.async = true;
        script.src = 'https://gumroad.com/js/gumroad.js';
        script.onload = function() {
          console.log('Gumroad script loaded successfully');
        };
        script.onerror = function() {
          console.error('Failed to load Gumroad script');
        };
        
        // 将脚本插入到文档头部
        var firstScript = document.getElementsByTagName('script')[0];
        firstScript.parentNode.insertBefore(script, firstScript);
        
        // 标记已加载
        window.__gumroadScriptLoaded = true;
      })();
    }
  }
</script>
